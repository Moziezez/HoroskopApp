<!DOCTYPE html>
<html lang="de" dir="ltr">

<body>
  <div class="plot-flex-container" id="plot-container">

    <div class="horo header">
      <div class="horo form">
        <h1 class="horo cntr">Dein Geburtshoroskop</h1>
        <h5 class="horo" id="hSystem" style="text-align: center"> Häusersystem: <%=userData.house%> </h5>
      </div>
    </div>

    <div class="flexItem1">
      <div class="newInput horo" id="infoForm">
        <a class="horo" id="triggerForm" onclick="popUpForm()">
          Eingabedaten ändern →
        </a>
      </div>
    </div>

    <div class="horo">
      <h3 class="horo cntr" id="h3Name"><%=userData.name%></h3>
      <p class="cntr" id="pUserInfo">
        <%=pUserInfoString%>
      </p>
    </div>

    <div class="flexItem2">
      <div class="signsBox sunSign">
        <div class="grid1 cOrange" style="font-size: 29px">☉</div>
        <div class="grid2 sublabel">STERNZEICHEN</div>
        <h4 class="grid3"><%= sunSign %></h4>
      </div>

      <div class="signsBox sunSign">
        <div class="grid1 cOrange">AC</div>
        <div class="grid2 sublabel">ASZENDENT</div>
        <h4 class="grid3"><%= ascendant %></h4>
      </div>

      <div class="signsBox sunSign">
        <div class="grid1 cOrange" style="font-size: 25px; font-weight: bold">
          ☽
        </div>
        <div class="grid2 sublabel">MONDZEICHEN</div>
        <h4 class="grid3"><%= moonSign %></h4>
      </div>
    </div>

    <div class="flexItem3">
      <div id="circularPlot"></div>
      <div>
        <a class="horo" id="triggerLegend" onclick="popUpLegend()">
          Legende →
        </a>
      </div>
      <div id="popupLegend" class="popupLegend hide">
        <div class="flexLegend">

          <div class="horo itemLegend">
            <% var count = 0 %>
            <% Object.entries(planets).forEach(([k, v], i) => { %>
            <% if ( ['sirius', 'ascendant', 'midheaven', 'southnode'].includes(k) ) return; %>

            <% var source = "../assets/components/svg/"+k+".svg"%>
            <div class="flexItemLegend">

              <div><%=v.text %></div>
              <div><img src=<%=source%> alt="svg" class="svgImgLegend" /></div>

            </div>
            <% count += 1 %>
            <% if (count%4 == 0) { %>

          </div>
          <div class="horo itemLegend">
            <% } %>
            <% }); %>
            <div class="flexItemLegend">
              <div>Aszendent</div>
              <div>AC</div>
            </div>
            <div class="flexItemLegend">
              <div>Himmelsmitte</div>
              <div>MC</div>
            </div>
            <div class="flexItemLegend">
              <div>Deszendent</div>
              <div>DC</div>
            </div>
          </div>

        </div>
        <div class="flexLegend">
          <div class="horo itemLegend">
            <% var count = 0 %>

            <% Object.entries(signs).forEach(([k, v], i) => { %>
            <% var source = "../assets/components/svg/"+k+".svg"%>
            <div class="flexItemLegend">
              <div><%=v.text %></div>
              <div><img src=<%=source%> alt="svg" class="svgImgLegend" /></div>
            </div>
            <% count += 1 %>
            <% if (count%3 == 0) { %>
          </div>
          <div class="horo itemLegend">
            <% } %>
            <% }); %>
          </div>
        </div>
      </div>
    </div>

    <div class="flexItem4">
      <h4 class="horo">INTERPRETATION</h4>
      <p class="horo">Das Geburtshoroskop kann umfassende und detaillierte Einsicht in die Persönlichkeit, Talente,
        Herausforderungen und das Lebenspotenzial eines Menschen geben, basierend auf der genauen
        Position der Planeten zum Zeitpunkt der Geburt.</p>
      <!-- <button class="butn" type="button" id="dlButton">DL</button> -->

      <script>
        var inputCity = "",
          inputCountry = "";
        autocompleteInput.on("select", (location) => {
          inputCity = location.properties.city;
          inputCountry = ", " + location.properties.country;
          var longi = Math.round(location.properties.lon * 100) / 100;
          document.getElementById("lon").value = longi;
          var lati = Math.round(location.properties.lat * 100) / 100;
          document.getElementById("lat").value = lati;
        });

        var horoButton = document.getElementById("but");
        horoButton.addEventListener("click", fetchHtmlData);
        document.addEventListener("DOMContentLoaded", function() {
          document.addEventListener("keydown", function(event) {
            if (event.key === "Enter") {
              $('#but').click();
            }
          });
        });

        $("#che").click(function(event) {
          var isChecked = event.target.checked;

          if (isChecked) {
            savedHour = $("#hour").val();
            savedMinu = $("#minu").val();
            savedHouse = $("#House").val();
            $("#hour").val("12");
            $("#minu").val("00");
            $("#House").val("whole-sign");
          } else {
            $("#hour").val(savedHour);
            $("#minu").val(savedMinu);
            $("#House").val(savedHouse);
          }
        });

        // async function fetchHtmlData(event) {
        //   event.preventDefault();
        //   var get_uri = <%- JSON.stringify( get_uri ) %>;

        //   const params = {
        //     name: document.getElementById("nam").value,
        //     date: document.getElementById("dat").value,
        //     hour: document.getElementById("hour").value,
        //     minu: document.getElementById("minu").value,
        //     longi: document.getElementById("lon").value,
        //     lati: document.getElementById("lat").value,
        //     house: document.getElementById("House").value,
        //     city: inputCity,
        //     country: inputCountry,
        //     zodi: document.getElementById("Trop").checked,
        //     check: document.getElementById("che").checked,
        //   };
        //   await axios
        //     .get(get_uri + "/get-html", {
        //       params
        //     })
        //     .then((response) => {
        //       document.open();
        //       document.write(response.data);
        //       document.close();
        //     })
        //     .catch((error) => {
        //       console.error("Error fetching HTML data:", error.message);
        //     });
        // }
      </script>

      <div class="flexText">
        <div class="signsTextBox" id="infoSun">
          <div class="flexText1 cOrange" style="line-height: 28px">
            <div style="font-size: 33px">☉</div>
          </div>
          <h6 class="flexText2 horo">Dein Sternzeichen</h6>
          <h3 class="flexText3 horo"><%= sunSign %></h3>
          <hr class="horo" />
          <p class="flexText4 horo">
            Das Sonnenzeichen (Sternzeichen) repräsentiert den Kern der Persönlichkeit und die
            grundlegenden Charakterzüge, die das Wesen und die Selbstwahrnehmung eines Menschen
            prägen.
          </p>
          <div id="popupSun" class="popup hide">
            <% if ( !checked ) { %>
            <% var sign_key = userData.sunsign %>
            <%-	include('./partials/sunsign', { key: sign_key }) %>
            <% } %>
          </div>
          <div class="flexText5 horo">
            <a class="horo" id="triggerSun" onclick="popUp('Sun')">
              Zur Interpretation →
            </a>
          </div>
        </div>
        <div class="signsTextBox" id="infoAc">
          <div class="flexText1 cOrange" style="line-height: 25px">
            <div style="font-size: 16px; margin-right: 3px">AC</div>
          </div>
          <h6 class="flexText2 horo">Dein Aszendent</h6>
          <h3 class="flexText3 horo"><%= ascendant %></h3>
          <hr class="horo" />
          <p class="flexText4 horo">
            Der Aszendent beschreibt, wie ein Mensch nach außen hin wirkt und in der Welt auftritt, sowie die
            Art und Weise, wie er auf seine Umgebung reagiert und von anderen wahrgenommen wird
          </p>
          <div id="popupAc" class="popup hide">
            <% if ( !checked ) { %>
            <% var asc_link = './partials/houses/ascendant_signs'; %>
            <% var asc_key = houses[1].sign_key; %>
            <%- include( asc_link, { key: asc_key } ); %>
            <% } %>
          </div>
          <div class="flexText5 horo">
            <a class="horo" id="triggerAc" onclick="popUp('Ac')">
              Zur Interpretation →
            </a>
          </div>
        </div>

        <div class="signsTextBox" id="infoMoon">
          <div class="flexText1 cOrange" style="line-height: 26px">
            <div style="font-size: 26px; margin-left: 3px">☽</div>
          </div>
          <h6 class="flexText2 horo">Dein Mondzeichen</h6>
          <h3 class="flexText3 horo"><%= moonSign %></h3>
          <hr class="horo" />
          <p class="flexText4 horo">
            Das Mondzeichen repräsentiert die emotionale Natur eines Menschen, seine inneren Bedürfnisse,
            Gefühle und unbewussten Reaktionen.
          </p>
          <div id="popupMoon" class="popup hide">
            <% if ( !checked ) { %>
            <% var sign_key = userData.moonsign %>
            <%- include('./partials/moonsign', { key: sign_key }); %>
            <% } %>
          </div>
          <div class="flexText5 horo">
            <a class="horo" id="triggerMoon" onclick="popUp('Moon')">
              Zur Interpretation →
            </a>
          </div>
        </div>
      </div>

      <h4 class="horo">Wechselwirkungen</h4>
      <div class="flexText">
        <div class="signsTextBox" id="infoSunAc">
          <div class="flexTextWw1 cOrange">
            <div style="font-size: 33px; display: inline; margin-top: -5px">
              ☉
            </div>
            <div style="font-size: 25px; display: inline; margin-top: -2px">
              ↔
            </div>
            <div style="font-size: 14pt; display: inline">AC</div>
          </div>
          <h6 class="flexText2 horo">Kombination Sonne & Aszendent</h6>
          <h3 class="flexText3 horo"><%= sunSign %> & <%= ascendant %></h3>
          <hr class="horo" />
          <p class="flexText4 horo">
            Die kombinierte Deutung von Sternzeichen und Aszendent zeigt, wie der innere Wesenskern eines
            Menschen durch sein äußeres Erscheinungsbild und Verhalten zum Ausdruck kommt.
          </p>
          <div id="popupSunAc" class="popup hide">
            <% if ( !checked ) { %>
            <% var sun_key = userData.sunsign %>
            <% var asc_key = houses[1].sign_key; %>
            <%-	include('./partials/asc_sun_' + sun_key, { key2: asc_key }); %>
            <% } %>
          </div>
          <div class="flexText5 horo">
            <a class="horo" id="triggerSunAc" onclick="popUp('SunAc')">
              Zur Interpretation →
            </a>
          </div>
        </div>
        <div class="signsTextBox" id="infoSunMoon">
          <div class="flexTextWw1 cOrange">
            <div style="font-size: 33px; display: inline; margin-top: -5px">
              ☉
            </div>
            <div style="font-size: 25px; display: inline; margin-top: -2px">
              ↔
            </div>
            <div style="font-size: 20pt; display: inline; margin-top: -3px">
              ☽
            </div>
          </div>
          <h6 class="flexText2 horo">Kombination Sonne & Mond</h6>
          <h3 class="flexText3 horo"><%= sunSign %> & <%= moonSign %></h3>
          <hr class="horo" />
          <p class="flexText4 horo">
            Die Kombination von Sonnenzeichen und Mondzeichen offenbart, wie der innere Wesenskern
            eines Menschen mit seinen emotionalen Bedürfnissen und Reaktionen harmoniert und interagiert.
          </p>
          <div id="popupSunMoon" class="popup hide">
            <% if ( !checked ) { %>
            <% var sun_key = userData.sunsign %>
            <% var moon_key = userData.moonsign; %>
            <%- include('./partials/moon_sun_' + sun_key, { key2: moon_key }); %>
            <% } %>
          </div>
          <div class="flexText5 horo">
            <a class="horo" id="triggerSunMoon" onclick="popUp('SunMoon')">
              Zur Interpretation →
            </a>
          </div>
        </div>
      </div>
    </div>

    <div class="flexItem5">
      <h4 class="horo">ASPEKTE</h4>
      <div class="cartesianDiv">
        <p class="horo half">
          Die Aspekte der Planeten untereinander zeigen die dynamischen Beziehungen und
          Wechselwirkungen zwischen verschiedenen Bereichen des Lebens an, wobei harmonische
          Aspekte positive Synergien und Wachstumschancen fördern, während Spannungsaspekte auf
          Konflikte und Herausforderungen hinweisen. </br>
          Der Orbis gibt an, um wie viel Grad der jeweilige Aspekt vom exakten Winkel abweicht.
          Je höher dieser Wert, desto schwächer ist also die Wirkung des Aspekts.
        </p>
        <div class="horo half2">
          <div id="cartesianPlot"></div>
        </div>
      </div>
    </div>

    <div class="flexItem6">
      <h4 class="horo">POSITIONEN</h4>
      <p class="horo">
        Die Planeten und Himmelskörper bewohnen die 12 astrologischen Häuser, welche verschiedene Lebensbereiche darstellen.
        Dadurch beeinflussen sie diese Bereiche mit ihren charakteristischen Energien und zeigen vorherrschende Themen auf.
      </p>
      <div class="positions">
        <div class="leftPos">
          <% Object.entries(planets).forEach(([k, v], i) => { %>
          <% if ( ['sirius', 'ascendant', 'midheaven'].includes(k) ) return; %>
          <% var source = "../assets/components/svg/"+k+".svg"%>
          <p class="horo" id=<%=k%>></p>
          <img src=<%=source%> alt="svg" class="svgImgLegend" />
          <b><%=v.text%></b> in
          <span class="pos">
            <%= planets[k].pos_name; %>
            <% console.log(v.sign_id, "SIGN ID"); %>
            <%= signs[v.sign_id].text; %>
          </span>, Haus <%=v.house_id%>
          </p>
          <% if ( i == 6) { %>
        </div>
        <div class="rightPos">
          <% }%>
          <% }); %>
        </div>
      </div>
    </div>
  </div>
</body>
<!-- 
<script src="../assets/plotFunc.js"></script> -->

</html>